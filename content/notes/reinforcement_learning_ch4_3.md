---
title: "ジャックのレンタカー会社問題(強化学習第2版 4.3 方策反復)"
tags: ["Reinforcement Learning"]
date: 2023-01-10T15:00:00+09:00
---

# ジャックのレンタカー会社問題

ジャックのレンタカー会社問題について方策反復を用いて最適方策を求めた。本と同じ結果を得ることができた。

実装は、[reinforcement\_learning/main.cpp at main - niuez/reinforcement\_learning](https://github.com/niuez/reinforcement_learning/blob/fc57a8c63cdf4b6cb5c4632cf61cd0c89867e45a/jacks_rental_car/main.cpp)に載せてある。

# 練習問題4.7

上の拡張を行えば良い。$V(s)$についてプロットすると以下のようになった。

![](notes/reinforcement_img/ext_value_surface.png)

各状態における行動は以下のようになった。右向きに1つ目の支店の台数、下向きに2つ目の支店の台数、行動は「1つ目の支店の台数の変化」で著している。

```
 0  0  0  0  0  0  0  0  1  1  2  2  2  3  4  5  4  4  4  4  4 
 0  0  0  0  0  0  0  0  0  1  1  1  2  3  4  5  3  3  3  3  4 
 0  0  0  0  0  0  0  0  0  0  0  1  2  3  4  2  2  2  2  3  3 
 0  0  0  0  0  0  0  0  0  0  0  1  2  3  1  1  1  1  2  2  2 
 0  0  0  0  0  0  0  0  0  0  0  1  2  0  0  0  0  1  1  1  1 
 0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0 
-2  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0 
-3 -3 -2  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0 
-4 -3 -3  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0 
-4 -4 -3 -3  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0 
-5 -4 -4 -3  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 
-5 -5 -4 -4 -3 -3 -2 -1 -1 -1  0 -1 -1 -1 -1 -1 -1 -1 -1 -1  0 
-5 -5 -5 -4 -4 -3 -2 -2 -2  0  0 -2 -2 -2 -2 -2 -2 -2 -2  0  0 
-5 -5 -5 -5 -4 -3 -3 -3  0  0  0  1  0  0  0  0  0  0  0  0  0 
-5 -5 -5 -5 -4 -4 -4  0  0  0  0  1  0  0  0  0  0  0  0  0  0 
-5 -5 -5 -5 -5 -5  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0 
-5 -5 -5 -5 -5 -4  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0 
-5 -5 -5 -5 -5 -4  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0 
-5 -5 -5 -5 -5 -4  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0 
-5 -5 -5 -5 -5 -4 -3  0  0  0  0  1  0  0  0  0  0  0  0  0  0 
-5 -5 -5 -5 -5 -4 -3  0  0  0  0  0  0  0  0  0  0  0  0  0  0 
```
